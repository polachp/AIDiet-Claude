<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Diet - Sledov√°n√≠ kalori√≠</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Authentication Screen -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üçΩÔ∏è AI Diet</h1>
                <p>P≈ôihlaste se pro sledov√°n√≠ kalori√≠</p>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form">
                <h2>P≈ôihl√°≈°en√≠</h2>
                <div class="form-group">
                    <label for="loginEmail">Email:</label>
                    <input type="email" id="loginEmail" placeholder="vas@email.cz" />
                </div>
                <div class="form-group">
                    <label for="loginPassword">Heslo:</label>
                    <input type="password" id="loginPassword" placeholder="Va≈°e heslo" />
                </div>
                <button onclick="loginWithEmail()" class="btn-primary btn-full">üîê P≈ôihl√°sit se</button>

                <div class="auth-divider">
                    <span>nebo</span>
                </div>

                <button onclick="loginWithGoogle()" class="btn-google btn-full">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
                    P≈ôihl√°sit p≈ôes Google
                </button>

                <p class="auth-switch">
                    Nem√°te √∫ƒçet? <a href="#" onclick="showRegisterForm(); return false;">Zaregistrujte se</a>
                </p>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="auth-form" style="display: none;">
                <h2>Registrace</h2>
                <div class="form-group">
                    <label for="registerEmail">Email:</label>
                    <input type="email" id="registerEmail" placeholder="vas@email.cz" />
                </div>
                <div class="form-group">
                    <label for="registerPassword">Heslo:</label>
                    <input type="password" id="registerPassword" placeholder="Minim√°lnƒõ 6 znak≈Ø" />
                </div>
                <div class="form-group">
                    <label for="registerPasswordConfirm">Potvrdit heslo:</label>
                    <input type="password" id="registerPasswordConfirm" placeholder="Zopakujte heslo" />
                </div>
                <button onclick="registerWithEmail()" class="btn-primary btn-full">üìù Zaregistrovat se</button>

                <div class="auth-divider">
                    <span>nebo</span>
                </div>

                <button onclick="loginWithGoogle()" class="btn-google btn-full">
                    <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
                    Registrovat p≈ôes Google
                </button>

                <p class="auth-switch">
                    U≈æ m√°te √∫ƒçet? <a href="#" onclick="showLoginForm(); return false;">P≈ôihlaste se</a>
                </p>
            </div>

            <!-- Error/Success Messages -->
            <div id="authMessage" class="auth-message" style="display: none;"></div>
        </div>
    </div>

    <!-- Main App Container (hidden until authenticated) -->
    <div id="mainApp" class="container" style="display: none;">
        <header>
            <h1>üçΩÔ∏è AI calories count</h1>
            <p>Sledov√°n√≠ kalori√≠ s pomoc√≠ AI v ver 0.2 - vercel connect</p>
            <div class="header-actions">
                <button onclick="toggleSettings()" class="settings-btn" id="settingsBtn">‚öôÔ∏è Nastaven√≠</button>
                <button onclick="logoutUser()" class="logout-btn" id="logoutBtn">Odhl√°sit</button>
            </div>
        </header>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div class="modal-overlay" onclick="toggleSettings()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Nastaven√≠</h2>
                    <button class="modal-close" onclick="toggleSettings()">Zav≈ô√≠t</button>
                </div>
                <div class="modal-body">
                    <!-- API kl√≠ƒç -->
                    <div id="apiKeySection">
                        <div class="form-group">
                            <label for="apiKey">Gemini API kl√≠ƒç:</label>
                            <input type="password" id="apiKey" placeholder="Zadejte v√°≈° Gemini API kl√≠ƒç">
                            <button onclick="saveApiKey()">üíæ Ulo≈æit kl√≠ƒç</button>
                            <small>Z√≠skejte zdarma na <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></small>
                        </div>
                    </div>

                    <!-- U≈æivatelsk√© √∫daje -->
                    <div class="user-data-section" id="userDataSection">
                        <h3 style="margin-top: 16px; margin-bottom: 12px; color: var(--text-primary); font-size: 1.1em; font-weight: 600;">Osobn√≠ √∫daje (pro v√Ωpoƒçet denn√≠ho p≈ô√≠jmu)</h3>
                        <div class="user-data-grid">
                            <div class="form-group">
                                <label for="userAge">Vƒõk (roky):</label>
                                <input type="number" id="userAge" placeholder="25" min="10" max="120">
                            </div>
                            <div class="form-group">
                                <label for="userGender">Pohlav√≠:</label>
                                <select id="userGender">
                                    <option value="male">Mu≈æ</option>
                                    <option value="female">≈Ωena</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="userWeight">V√°ha (kg):</label>
                                <input type="number" id="userWeight" placeholder="70" min="30" max="300" step="0.1">
                            </div>
                            <div class="form-group">
                                <label for="userHeight">V√Ω≈°ka (cm):</label>
                                <input type="number" id="userHeight" placeholder="175" min="100" max="250">
                            </div>
                            <div class="form-group">
                                <label for="userActivity">Aktivita:</label>
                                <select id="userActivity">
                                    <option value="1.2">Sedav√© zamƒõstn√°n√≠</option>
                                    <option value="1.375">Lehk√° aktivita (1-3x t√Ωdnƒõ)</option>
                                    <option value="1.55" selected>St≈ôednƒõ aktivn√≠ (3-5x t√Ωdnƒõ)</option>
                                    <option value="1.725">Velmi aktivn√≠ (6-7x t√Ωdnƒõ)</option>
                                    <option value="1.9">Extra aktivn√≠ (2x dennƒõ)</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="saveUserData()" class="btn-primary" style="margin-top: 12px;">üíæ Ulo≈æit osobn√≠ √∫daje</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vstupn√≠ formul√°≈ô -->
        <section class="input-section">
            <h2>P≈ôidat j√≠dlo</h2>

            <!-- Tab menu - iOS Segmented Control Style -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('text', event)">üìù Text</button>
                <button class="tab-btn" onclick="switchTab('photo', event)">üì∑ Foto</button>
                <button class="tab-btn" onclick="switchTab('voice', event)">üé§ Hlas</button>
            </div>

            <!-- Textov√Ω vstup -->
            <div id="textTab" class="tab-content active">
                <div class="form-group">
                    <input type="text" id="textInput" placeholder="Nap≈ô.: 'dva rohl√≠ky s m√°slem a ≈°unkou, jogurt'" />
                    <button onclick="analyzeText()" class="btn-primary" style="margin-top: 12px;">üîç Analyzovat</button>
                </div>
            </div>

            <!-- Foto vstup -->
            <div id="photoTab" class="tab-content">
                <div class="form-group">
                    <input type="file" id="photoInput" accept="image/*" capture="environment">
                    <small>üì∏ Foto se automaticky analyzuje po v√Ωbƒõru</small>
                    <div id="photoPreview" class="photo-preview"></div>
                    <div id="photoLoading" class="inline-loading" style="display: none;">
                        <div class="spinner-small"></div>
                        <span>Analyzuji fotografii...</span>
                    </div>
                </div>
            </div>

            <!-- Hlasov√Ω vstup -->
            <div id="voiceTab" class="tab-content">
                <div class="form-group">
                    <button onclick="startVoiceRecognition()" id="voiceBtn" class="btn-primary">üé§ Zaƒç√≠t nahr√°vat</button>
                    <div id="voiceLoading" class="inline-loading" style="display: none;">
                        <div class="spinner-small"></div>
                        <span>Zpracov√°v√°m hlasov√Ω vstup...</span>
                    </div>
                </div>
            </div>

            <!-- Loading indicator -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Analyzuji j√≠dlo...</p>
            </div>
        </section>

        <!-- Denn√≠ p≈ôehled -->
        <section class="daily-summary">
            <!-- <h2><span id="currentDate"></span></h2> -->

            <!-- Celkov√© kalorie -->
            <div class="calories-main">
                <div class="calories-header">
                    <div class="calories-percentage" id="caloriesPercentage">0%</div>
                    <div class="calories-secondary">
                        <span id="totalCalories">0</span> / <span id="caloriesGoalValue">2000</span> kcal
                    </div>
                </div>
                <div class="calories-progress-bar">
                    <div class="calories-progress-fill" id="caloriesProgressFill"></div>
                </div>
            </div>

            <!-- Makro≈æiviny - minimalistick√© boxy -->
            <div class="macros-grid">
                <!-- B√≠lkoviny -->
                <div class="macro-box" data-macro="protein">
                    <div class="macro-box-icon">ü•©</div>
                    <div class="macro-box-label">B√≠lkoviny</div>
                    <div class="macro-box-percent" id="proteinPercent">0%</div>
                    <div class="macro-box-value">
                        <span id="totalProtein">0</span>g
                    </div>
                    <div class="macro-box-goal" id="proteinGoal">z 0g</div>
                </div>

                <!-- Sacharidy -->
                <div class="macro-box" data-macro="carbs">
                    <div class="macro-box-icon">üåæ</div>
                    <div class="macro-box-label">Sacharidy</div>
                    <div class="macro-box-percent" id="carbsPercent">0%</div>
                    <div class="macro-box-value">
                        <span id="totalCarbs">0</span>g
                    </div>
                    <div class="macro-box-goal" id="carbsGoal">z 0g</div>
                </div>

                <!-- Tuky -->
                <div class="macro-box" data-macro="fat">
                    <div class="macro-box-icon">ü•ë</div>
                    <div class="macro-box-label">Tuky</div>
                    <div class="macro-box-percent" id="fatPercent">0%</div>
                    <div class="macro-box-value">
                        <span id="totalFat">0</span>g
                    </div>
                    <div class="macro-box-goal" id="fatGoal">z 0g</div>
                </div>
            </div>
        </section>

        <!-- Seznam j√≠del -->
        <section class="meals-section">
            <h2>Seznam j√≠del</h2>
            <div id="mealsList" class="meals-list">
                <p class="empty-state">Zat√≠m ≈æ√°dn√° j√≠dla. P≈ôidejte sv√© prvn√≠ j√≠dlo!</p>
            </div>
        </section>
    </div>

    <!-- Firebase SDK (v9 compat mode) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>

    <!-- Firestore Service Layer -->
    <script src="firestore-service.js"></script>

    <!-- Authentication -->
    <script src="auth.js"></script>

    <!-- Main App -->
    <script src="app.js"></script>
</body>
</html>
